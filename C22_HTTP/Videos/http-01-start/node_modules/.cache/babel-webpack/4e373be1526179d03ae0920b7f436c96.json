{"ast":null,"code":"import { Subject } from '../Subject';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function retryWhen(notifier) {\n  return operate(function (source, subscriber) {\n    var innerSub;\n    var syncResub = false;\n    var errors$;\n\n    var subscribeForRetryWhen = function subscribeForRetryWhen() {\n      innerSub = source.subscribe(createOperatorSubscriber(subscriber, undefined, undefined, function (err) {\n        if (!errors$) {\n          errors$ = new Subject();\n          notifier(errors$).subscribe(createOperatorSubscriber(subscriber, function () {\n            return innerSub ? subscribeForRetryWhen() : syncResub = true;\n          }));\n        }\n\n        if (errors$) {\n          errors$.next(err);\n        }\n      }));\n\n      if (syncResub) {\n        innerSub.unsubscribe();\n        innerSub = null;\n        syncResub = false;\n        subscribeForRetryWhen();\n      }\n    };\n\n    subscribeForRetryWhen();\n  });\n}","map":{"version":3,"sources":["../../../../src/internal/operators/retryWhen.ts"],"names":[],"mappings":"AACA,SAAS,OAAT,QAAwB,YAAxB;AAIA,SAAS,OAAT,QAAwB,cAAxB;AACA,SAAS,wBAAT,QAAyC,sBAAzC;AAyDA,OAAM,SAAU,SAAV,CAAuB,QAAvB,EAA6E;AACjF,SAAO,OAAO,CAAC,UAAC,MAAD,EAAS,UAAT,EAAuB;AACpC,QAAI,QAAJ;AACA,QAAI,SAAS,GAAG,KAAhB;AACA,QAAI,OAAJ;;AAEA,QAAM,qBAAqB,GAAG,SAAxB,qBAAwB,GAAK;AACjC,MAAA,QAAQ,GAAG,MAAM,CAAC,SAAP,CACT,wBAAwB,CAAC,UAAD,EAAa,SAAb,EAAwB,SAAxB,EAAmC,UAAC,GAAD,EAAQ;AACjE,YAAI,CAAC,OAAL,EAAc;AACZ,UAAA,OAAO,GAAG,IAAI,OAAJ,EAAV;AACA,UAAA,QAAQ,CAAC,OAAD,CAAR,CAAkB,SAAlB,CACE,wBAAwB,CAAC,UAAD,EAAa;AAAA,mBAMnC,QAAQ,GAAG,qBAAqB,EAAxB,GAA8B,SAAS,GAAG,IANf;AAAA,WAAb,CAD1B;AAUD;;AACD,YAAI,OAAJ,EAAa;AAEX,UAAA,OAAO,CAAC,IAAR,CAAa,GAAb;AACD;AACF,OAlBuB,CADf,CAAX;;AAsBA,UAAI,SAAJ,EAAe;AAKb,QAAA,QAAQ,CAAC,WAAT;AACA,QAAA,QAAQ,GAAG,IAAX;AAEA,QAAA,SAAS,GAAG,KAAZ;AAEA,QAAA,qBAAqB;AACtB;AACF,KAnCD;;AAsCA,IAAA,qBAAqB;AACtB,GA5Ca,CAAd;AA6CD","sourceRoot":"","sourcesContent":["import { Subject } from '../Subject';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function retryWhen(notifier) {\n    return operate((source, subscriber) => {\n        let innerSub;\n        let syncResub = false;\n        let errors$;\n        const subscribeForRetryWhen = () => {\n            innerSub = source.subscribe(createOperatorSubscriber(subscriber, undefined, undefined, (err) => {\n                if (!errors$) {\n                    errors$ = new Subject();\n                    notifier(errors$).subscribe(createOperatorSubscriber(subscriber, () => innerSub ? subscribeForRetryWhen() : (syncResub = true)));\n                }\n                if (errors$) {\n                    errors$.next(err);\n                }\n            }));\n            if (syncResub) {\n                innerSub.unsubscribe();\n                innerSub = null;\n                syncResub = false;\n                subscribeForRetryWhen();\n            }\n        };\n        subscribeForRetryWhen();\n    });\n}\n//# sourceMappingURL=retryWhen.js.map"]},"metadata":{},"sourceType":"module"}